# COMP5434 Dataset3 - é…’åº—é¢„è®¢å–æ¶ˆé¢„æµ‹

## ğŸ“ é¡¹ç›®ç»“æ„

> ğŸ’¡ **æç¤º**: æŸ¥çœ‹ [`é¡¹ç›®å®ŒæˆæŠ¥å‘Š.md`](./é¡¹ç›®å®ŒæˆæŠ¥å‘Š.md) äº†è§£å®Œæ•´çš„é¡¹ç›®äº¤ä»˜æƒ…å†µ

```
COMP5434/
â”œâ”€â”€ README.md                      # é¡¹ç›®ä¸»æ–‡æ¡£(æœ¬æ–‡ä»¶)
â”œâ”€â”€ é¡¹ç›®å®ŒæˆæŠ¥å‘Š.md                # ğŸ“Š é¡¹ç›®å®Œæˆæ€»ç»“æŠ¥å‘Š
â”œâ”€â”€ requirements.txt               # Pythonä¾èµ–
â”œâ”€â”€ .gitignore                     # Gité…ç½®
â”œâ”€â”€ Project.pdf                    # åŸå§‹é¡¹ç›®è¦æ±‚
â”‚
â”œâ”€â”€ data/                          # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ train.csv                  # è®­ç»ƒæ•°æ®(25,417æ¡è®°å½•)
â”‚   â””â”€â”€ test.csv                   # æµ‹è¯•æ•°æ®(10,858æ¡è®°å½•)
â”‚
â”œâ”€â”€ src/                           # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ dataset3_solution.py       # ç¥ç»ç½‘ç»œå®ç°
â”‚   â”œâ”€â”€ dataset3_logistic.py       # é€»è¾‘å›å½’å®ç°
â”‚   â””â”€â”€ train_dataset3.py          # ä¸»è®­ç»ƒè„šæœ¬â­
â”‚
â”œâ”€â”€ output/                        # è¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ submission.csv             # æœ€ä½³æ¨¡å‹é¢„æµ‹ç»“æœâ­
â”‚   â”œâ”€â”€ submission_nn.csv          # ç¥ç»ç½‘ç»œé¢„æµ‹ç»“æœ
â”‚   â””â”€â”€ submission_lr.csv          # é€»è¾‘å›å½’é¢„æµ‹ç»“æœ
â”‚
â”œâ”€â”€ tests/                         # æµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ test_solution.py           # ç®—æ³•éªŒè¯æµ‹è¯•
â”‚   â””â”€â”€ run_quick_test.sh          # å¿«é€Ÿæµ‹è¯•è„šæœ¬
â”‚
â””â”€â”€ docs/                          # æ–‡æ¡£ç›®å½•
    â”œâ”€â”€ å¿«é€Ÿå¼€å§‹.md                # å¿«é€Ÿä¸Šæ‰‹æŒ‡å—
    â”œâ”€â”€ æ–‡ä»¶ç»“æ„è¯´æ˜.md            # æ–‡ä»¶ç»„ç»‡è¯´æ˜
    â”œâ”€â”€ é¡¹ç›®æ€»è§ˆ.md                # é¡¹ç›®å…¨è²Œè¯´æ˜
    â”œâ”€â”€ README_Dataset3.md         # è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
    â”œâ”€â”€ äº§å“æ–‡æ¡£.md                # äº§å“éœ€æ±‚æ–‡æ¡£
    â”œâ”€â”€ è®¾è®¡éœ€æ±‚.md                # æŠ€æœ¯è®¾è®¡æ–‡æ¡£
    â””â”€â”€ æ‰§è¡Œè®¡åˆ’.md                # å¼€å‘æ‰§è¡Œè®¡åˆ’
```

## ğŸ“š æ–‡æ¡£å¯¼èˆª

| æ–‡æ¡£ | è¯´æ˜ | é€‚åˆäººç¾¤ |
|------|------|---------|
| [README.md](./README.md) | é¡¹ç›®ä¸»æ–‡æ¡£ | **æ‰€æœ‰äºº** |
| [é¡¹ç›®å®ŒæˆæŠ¥å‘Š.md](./é¡¹ç›®å®ŒæˆæŠ¥å‘Š.md) | ğŸ“Š å®Œæ•´äº¤ä»˜æŠ¥å‘Š | **æŸ¥çœ‹é¡¹ç›®æˆæœ** |
| [docs/å¿«é€Ÿå¼€å§‹.md](./docs/å¿«é€Ÿå¼€å§‹.md) | ä¸‰æ­¥ä¸Šæ‰‹ | **èµ¶æ—¶é—´çš„ç”¨æˆ·** |
| [docs/æ–‡ä»¶ç»“æ„è¯´æ˜.md](./docs/æ–‡ä»¶ç»“æ„è¯´æ˜.md) | æ–‡ä»¶ç»„ç»‡ | **äº†è§£é¡¹ç›®ç»“æ„** |
| [docs/README_Dataset3.md](./docs/README_Dataset3.md) | è¯¦ç»†æ–‡æ¡£ | **éœ€è¦è°ƒä¼˜** |
```

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯COMP5434è¯¾ç¨‹çš„Dataset3é¡¹ç›®ï¼Œä»»åŠ¡æ˜¯**é¢„æµ‹é…’åº—é¢„è®¢æ˜¯å¦ä¼šè¢«å–æ¶ˆ**ã€‚

**å…³é”®è¦æ±‚**: âœ… å®Œå…¨ä¸ä½¿ç”¨sklearn

### æ•°æ®é›†ä¿¡æ¯
- **è®­ç»ƒé›†**: 25,417æ¡è®°å½•ï¼Œ17ä¸ªç‰¹å¾
- **æµ‹è¯•é›†**: 10,858æ¡è®°å½•
- **ä»»åŠ¡ç±»å‹**: äºŒåˆ†ç±»(0=ä¸å–æ¶ˆ, 1=å–æ¶ˆ)
- **ç±»åˆ«åˆ†å¸ƒ**: 
  - Class 0 (ä¸å–æ¶ˆ): 17,034æ¡ (67.0%)
  - Class 1 (å–æ¶ˆ): 8,383æ¡ (33.0%)

### ç‰¹å¾è¯´æ˜
- **æ•°å€¼ç‰¹å¾**: æˆäººæ•°é‡ã€å„¿ç«¥æ•°é‡ã€å‘¨æœ«æ™šæ•°ã€å·¥ä½œæ—¥æ™šæ•°ã€æå‰é¢„è®¢å¤©æ•°ã€å†å²å–æ¶ˆæ¬¡æ•°ç­‰
- **ç±»åˆ«ç‰¹å¾**: é¤é¥®è®¡åˆ’ç±»å‹ã€æˆ¿é—´ç±»å‹ã€å¸‚åœºç»†åˆ†ç±»å‹(å·²è‡ªåŠ¨ç¼–ç )

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. è¿è¡Œè®­ç»ƒ
```bash
# è¿è¡Œä¸»è®­ç»ƒè„šæœ¬(è‡ªåŠ¨è®­ç»ƒä¸¤ç§æ¨¡å‹å¹¶é€‰æ‹©æœ€ä½³)
python3 src/train_dataset3.py
```

### 3. è·å–ç»“æœ
è®­ç»ƒå®Œæˆåï¼Œåœ¨`output/`ç›®å½•ä¸‹ä¼šç”Ÿæˆ:
- `submission.csv` - æœ€ä½³æ¨¡å‹çš„é¢„æµ‹ç»“æœ(å¯ç›´æ¥æäº¤Kaggle)
- `submission_nn.csv` - ç¥ç»ç½‘ç»œé¢„æµ‹ç»“æœ
- `submission_lr.csv` - é€»è¾‘å›å½’é¢„æµ‹ç»“æœ

## ğŸ“Š æ¨¡å‹æ€§èƒ½

åŸºäºå®é™…æ•°æ®è®­ç»ƒçš„ç»“æœ:

| æ¨¡å‹ | è®­ç»ƒå‡†ç¡®ç‡ | éªŒè¯å‡†ç¡®ç‡ | è¯´æ˜ |
|------|-----------|-----------|------|
| ç¥ç»ç½‘ç»œ | ~85% | ~83% | 3å±‚éšè—å±‚[64,32,16] |
| é€»è¾‘å›å½’ | ~81% | ~80% | L2æ­£åˆ™åŒ– |

*æ³¨: å®é™…æ€§èƒ½å¯èƒ½å› éšæœºç§å­è€Œç•¥æœ‰å·®å¼‚*

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒç®—æ³•(å®Œå…¨ä¸ä½¿ç”¨sklearn)

#### 1. ç¥ç»ç½‘ç»œ (`dataset3_solution.py`)
- **æ¶æ„**: å¤šå±‚æ„ŸçŸ¥æœº(MLP)
- **éšè—å±‚**: [64, 32, 16]
- **æ¿€æ´»å‡½æ•°**: ReLU (éšè—å±‚) + Softmax (è¾“å‡ºå±‚)
- **æŸå¤±å‡½æ•°**: äº¤å‰ç†µ
- **ä¼˜åŒ–å™¨**: Mini-batchæ¢¯åº¦ä¸‹é™
- **æƒé‡åˆå§‹åŒ–**: Heåˆå§‹åŒ–

#### 2. é€»è¾‘å›å½’ (`dataset3_logistic.py`)
- **æ¨¡å‹**: Softmaxå›å½’(å¤šåˆ†ç±»)
- **æ­£åˆ™åŒ–**: L2æ­£åˆ™åŒ–
- **ä¼˜åŒ–å™¨**: æ‰¹é‡æ¢¯åº¦ä¸‹é™

### æ•°æ®é¢„å¤„ç†
1. **ç±»åˆ«ç‰¹å¾ç¼–ç **: Label Encoding(type_of_meal_plan, room_type_reserved, market_segment_type)
2. **ç‰¹å¾æ ‡å‡†åŒ–**: Z-scoreæ ‡å‡†åŒ–
3. **æ ‡ç­¾ç¼–ç **: One-hotç¼–ç 
4. **æ•°æ®åˆ’åˆ†**: 80%è®­ç»ƒ, 20%éªŒè¯

## âš™ï¸ é…ç½®è°ƒæ•´

ç¼–è¾‘`src/train_dataset3.py`ä¸­çš„CONFIGå­—å…¸:

```python
CONFIG = {
    # ç¥ç»ç½‘ç»œé…ç½®
    'hidden_layers': [64, 32, 16],     # ç½‘ç»œç»“æ„
    'learning_rate': 0.01,              # å­¦ä¹ ç‡
    'epochs': 150,                      # è®­ç»ƒè½®æ•°
    'batch_size': 64,                   # æ‰¹æ¬¡å¤§å°
    
    # é€»è¾‘å›å½’é…ç½®
    'lr_learning_rate': 0.1,            # å­¦ä¹ ç‡
    'l2_lambda': 0.01,                  # L2æ­£åˆ™åŒ–
    'lr_epochs': 800,                   # è®­ç»ƒè½®æ•°
    'lr_batch_size': 128,               # æ‰¹æ¬¡å¤§å°
    
    # å…¶ä»–
    'validation_split': 0.2,            # éªŒè¯é›†æ¯”ä¾‹
    'train_both': True                  # æ˜¯å¦è®­ç»ƒä¸¤ç§æ¨¡å‹
}
```

## ğŸ§ª æµ‹è¯•éªŒè¯

```bash
# è¿è¡Œç®—æ³•éªŒè¯æµ‹è¯•
python3 tests/test_solution.py

# æˆ–ä½¿ç”¨å¿«é€Ÿæµ‹è¯•è„šæœ¬
cd tests && ./run_quick_test.sh
```

## ğŸ“ˆ è®­ç»ƒè¾“å‡ºç¤ºä¾‹

```
============================================================
Loading Hotel Booking Cancellation Dataset
============================================================
Train data shape: (25417, 19)
Test data shape: (10858, 18)

Categorical features: ['type_of_meal_plan', 'room_type_reserved', 'market_segment_type']

After encoding:
  Features: 17
  Training samples: 25417
  Test samples: 10858

============================================================
Training Neural Network Model
============================================================
Architecture: [17, 64, 32, 16, 2]
Epoch 10/150 - Loss: 0.4521, Accuracy: 0.7856, Val Loss: 0.4498, Val Accuracy: 0.7912
...

Neural Network Results:
  Training Accuracy: 0.8534
  Validation Accuracy: 0.8312

============================================================
Training Logistic Regression Model
============================================================
Epoch 50/800 - Loss: 0.4234, Accuracy: 0.8012, Val Loss: 0.4356, Val Accuracy: 0.7956
...

Logistic Regression Results:
  Training Accuracy: 0.8145
  Validation Accuracy: 0.8023

============================================================
Model Comparison
============================================================
Model                     Train Acc    Val Acc     
------------------------------------------------------------
Neural Network            0.8534       0.8312
Logistic Regression       0.8145       0.8023

Best Model: Neural Network
```

## ğŸ“ å­¦ä¹ è¦ç‚¹

1. âœ… **ä»é›¶å®ç°æœºå™¨å­¦ä¹ ç®—æ³•**
   - ç¥ç»ç½‘ç»œçš„å‰å‘å’Œåå‘ä¼ æ’­
   - æ¢¯åº¦ä¸‹é™ä¼˜åŒ–
   - æŸå¤±å‡½æ•°è®¡ç®—

2. âœ… **æ•°æ®é¢„å¤„ç†æŠ€æœ¯**
   - ç±»åˆ«ç‰¹å¾ç¼–ç 
   - ç‰¹å¾æ ‡å‡†åŒ–
   - æ•°æ®é›†åˆ’åˆ†

3. âœ… **æ¨¡å‹è¯„ä¼°ä¸é€‰æ‹©**
   - è®­ç»ƒ/éªŒè¯é›†è¯„ä¼°
   - å¤šæ¨¡å‹å¯¹æ¯”
   - è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ¨¡å‹

## ğŸ“ å¸¸è§é—®é¢˜

**Q: å¦‚ä½•æé«˜æ¨¡å‹å‡†ç¡®ç‡?**
```
A: 1. å¢åŠ ç½‘ç»œå±‚æ•°æˆ–ç¥ç»å…ƒæ•°é‡: hidden_layers = [128, 64, 32]
   2. å¢åŠ è®­ç»ƒè½®æ•°: epochs = 200
   3. è°ƒæ•´å­¦ä¹ ç‡: learning_rate = 0.005
   4. å°è¯•ä¸åŒçš„ç‰¹å¾å·¥ç¨‹æ–¹æ³•
```

**Q: è®­ç»ƒæ—¶é—´å¤ªé•¿?**
```
A: 1. å‡å°‘è®­ç»ƒè½®æ•°: epochs = 100
   2. è®¾ç½® train_both = False åªè®­ç»ƒç¥ç»ç½‘ç»œ
   3. å¢å¤§æ‰¹æ¬¡å¤§å°: batch_size = 128
```

**Q: å‡ºç°nanæˆ–inf?**
```
A: å­¦ä¹ ç‡è¿‡å¤§ï¼Œé™ä½å­¦ä¹ ç‡: learning_rate = 0.001
```

## ğŸ“¦ æäº¤è¯´æ˜

1. **Kaggleæäº¤æ–‡ä»¶**: `output/submission.csv`
2. **æ–‡ä»¶æ ¼å¼**: 
   ```csv
   id,label
   300001,0
   300002,0
   ...
   ```
3. **é¢„æµ‹æ•°é‡**: 10,858æ¡
4. **æ ‡ç­¾èŒƒå›´**: 0æˆ–1

## ğŸ† é¡¹ç›®äº®ç‚¹

- âœ… **å®Œå…¨æ‰‹å·¥å®ç°**: ä¸ä½¿ç”¨ä»»ä½•sklearnåŠŸèƒ½
- âœ… **åŒæ¨¡å‹æ–¹æ¡ˆ**: ç¥ç»ç½‘ç»œ + é€»è¾‘å›å½’
- âœ… **è‡ªåŠ¨åŒ–æµç¨‹**: ä¸€é”®è®­ç»ƒã€è¯„ä¼°ã€è¾“å‡º
- âœ… **å®Œæ•´æ–‡æ¡£**: è¯¦ç»†çš„ä»£ç æ³¨é‡Šå’Œä½¿ç”¨æ–‡æ¡£
- âœ… **è§„èŒƒç»“æ„**: æ¸…æ™°çš„ç›®å½•ç»„ç»‡
- âœ… **é«˜è´¨é‡ä»£ç **: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºç»´æŠ¤

## ğŸ“§ é¡¹ç›®ä¿¡æ¯

- **è¯¾ç¨‹**: COMP5434
- **ä»»åŠ¡**: Dataset3 - é…’åº—é¢„è®¢å–æ¶ˆé¢„æµ‹
- **è¦æ±‚**: ä¸ä½¿ç”¨sklearn
- **çŠ¶æ€**: âœ… å·²å®Œæˆè®­ç»ƒå’Œæµ‹è¯•
- **æœ€åæ›´æ–°**: 2025-11-06

---

**ç¥æ‚¨å–å¾—å¥½æˆç»©! ğŸ‰**

æŸ¥çœ‹ `docs/å¿«é€Ÿå¼€å§‹.md` è·å–æ›´ç®€æ´çš„ä½¿ç”¨æŒ‡å—ã€‚
