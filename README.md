# COMP5434 Dataset3 - 酒店预订取消预测 🏨

基于神经网络和逻辑回归的酒店预订取消预测系统，**完全不使用 sklearn 实现**。

## 项目简介 📋

本项目实现了两种机器学习算法来预测酒店预订是否会被取消：
- 🧠 **神经网络**: 验证准确率 83%
- 📊 **逻辑回归**: 验证准确率 80%
- 🚀 **增强版（NEW）**: 验证准确率目标 86-89%

核心要求：所有算法基于 NumPy 从零实现，不使用 scikit-learn。

> **最新更新**: 新增增强版模型！通过特征工程+集成学习+正则化技术，冲击88%+准确率。详见 [ENHANCEMENTS.md](./ENHANCEMENTS.md)

## 数据集说明 📊

- 训练集：25,417 条记录，17 个特征
- 测试集：10,858 条记录
- 任务类型：二分类（0=不取消，1=取消）
- 特征类型：数值型（成人数、儿童数、提前天数等）+ 类别型（餐饮类型、房间类型、市场细分）

## 快速开始 🚀

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行训练

**基础版本**（快速）：
```bash
python src/train_dataset3.py
```

**增强版本**（推荐，更高准确率）：
```bash
python src/train_enhanced.py
# 或后台运行
./quick_test_enhanced.sh
```

程序会自动完成以下流程：
1. 加载并预处理数据
2. 特征工程（增强版）
3. 训练神经网络和逻辑回归模型
4. 在验证集上评估性能
5. 集成多个模型（增强版）
6. 生成预测结果文件

### 输出文件

训练完成后，在 `output/` 目录下会生成：
- `submission.csv` - 最佳模型的预测结果（可直接提交）
- `submission_nn.csv` - 神经网络预测
- `submission_lr.csv` - 逻辑回归预测
- `submission_enhanced.csv` - 增强模型预测（推荐）⭐

## 模型架构 🏗️

### 神经网络 (MLP)

- 网络结构：3 层隐藏层 [64, 32, 16]
- 激活函数：ReLU（隐藏层）+ Softmax（输出层）
- 损失函数：交叉熵
- 优化方法：Mini-batch 梯度下降
- 权重初始化：He 初始化

### 逻辑回归 (Softmax)

- 模型类型：Softmax 多分类回归
- 正则化：L2 惩罚项
- 优化方法：批量梯度下降

## 实现细节 ⚙️

所有核心算法均使用 NumPy 手工实现：

- ✅ 前向传播与反向传播
- ✅ 梯度下降优化
- ✅ 交叉熵损失计算
- ✅ 数据预处理（标准化、编码）
- ✅ 训练/验证集划分

**完全不依赖 sklearn。**

## 项目结构 📁

```
├── src/
│   ├── train_dataset3.py          # 主训练脚本
│   ├── dataset3_solution.py       # 神经网络实现
│   └── dataset3_logistic.py       # 逻辑回归实现
├── data/
│   ├── train.csv                  # 训练数据
│   └── test.csv                   # 测试数据
├── output/
│   └── submission.csv             # 预测结果
├── tests/
│   └── test_solution.py           # 算法验证
└── docs/                          # 详细文档
```

## 性能表现 📈

| 模型 | 训练准确率 | 验证准确率 | 特征数 |
|------|----------|----------|--------|
| 神经网络 | 85.3% | 83.1% | 17 |
| 逻辑回归 | 81.5% | 80.2% | 17 |
| **增强集成** | - | **86-89%** (目标) | 28 |

**增强版亮点**:
- ✅ 11个新增衍生特征
- ✅ 3个模型集成（深层+宽层+LR）
- ✅ Dropout + 学习率衰减
- ✅ 早停机制防过拟合

## 参数配置 🔧

可以在 `src/train_dataset3.py` 中调整超参数：

```python
CONFIG = {
    'hidden_layers': [64, 32, 16],    # 网络层数
    'learning_rate': 0.01,             # 学习率
    'epochs': 150,                     # 训练轮数
    'batch_size': 64,                  # 批次大小
    'validation_split': 0.2            # 验证集比例
}
```

## 测试验证 🧪

```bash
python tests/test_solution.py
```

## 技术栈 💻

- Python 3.x
- NumPy - 数值计算
- Pandas - 数据处理

---

**课程项目**: COMP5434  
**完成时间**: 2025-11-06
