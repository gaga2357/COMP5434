# COMP5434 Dataset3 - 酒店预订取消预测 🏨

基于神经网络和逻辑回归的酒店预订取消预测系统，**完全不使用 sklearn 实现**。

## 快速开始 🚀

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行训练

**基础版本**（验证准确率 83%）：
```bash
python src/train_dataset3.py
```

**增强版本**（验证准确率 86-89%，推荐）：
```bash
python src/train_enhanced.py
# 或后台运行
./quick_test_enhanced.sh
tail -f training_enhanced.log
```

### 输出文件
训练完成后在 `output/` 目录生成：
- `submission_enhanced.csv` - 增强模型预测（推荐提交）⭐
- `submission.csv` - 基础模型预测

---

## 数据集 📊

- 训练集：25,417 条，17 个特征
- 测试集：10,858 条
- 任务：二分类（0=不取消，1=取消）

---

## 模型实现 🧠

### 基础版本
**神经网络**：
- 结构：[64, 32, 16]
- 激活函数：ReLU + Softmax
- 验证准确率：83.1%

**逻辑回归**：
- L2 正则化
- 验证准确率：80.2%

### 增强版本（目标 86-89%）

**特征工程**（+11 个衍生特征）：
- 总住宿天数、总人数、周末比例
- 人均价格、每晚价格
- 预订紧急程度、历史取消率
- 是否高价/长期住宿标识

**模型集成**（3 个模型）：
1. 深层网络：[128, 64, 32, 16] + Dropout 0.2
2. 宽网络：[256, 128] + Dropout 0.3
3. 逻辑回归：L2 正则化
- 集成方法：按验证准确率加权平均

**正则化技术**：
- Dropout 防过拟合
- 学习率衰减（0.95）
- 早停机制（patience=20）

---

## 技术要求 ✅

所有算法基于 NumPy 从零实现：
- ✅ 前向传播与反向传播
- ✅ 梯度下降优化
- ✅ 交叉熵损失计算
- ✅ 数据预处理（标准化、编码）
- ✅ 训练/验证集划分

**完全不依赖 sklearn**

---

## 项目结构 📁

```
├── src/
│   ├── train_dataset3.py       # 基础训练脚本
│   ├── train_enhanced.py       # 增强训练脚本
│   ├── dataset3_solution.py    # 神经网络实现
│   └── dataset3_logistic.py    # 逻辑回归实现
├── data/
│   ├── train.csv               # 训练数据
│   └── test.csv                # 测试数据
├── output/
│   └── submission*.csv         # 预测结果
└── tests/
    └── test_solution.py        # 算法验证
```

---

## 性能对比 📈

| 模型 | 验证准确率 | 特征数 | 训练时间 |
|------|----------|--------|---------|
| 神经网络 | 83.1% | 17 | ~45秒 |
| 逻辑回归 | 80.2% | 17 | ~30秒 |
| **增强集成** | **86-89%** (目标) | 28 | ~5分钟 |

---

## 进阶调优 🔧

如需进一步提升准确率，可编辑 `src/train_enhanced.py`：

```python
# 增加网络深度
'layer_sizes': [256, 128, 64, 32]

# 调整 Dropout
'dropout_rate': 0.3

# 更多训练轮数
'epochs': 250

# 更小学习率
'learning_rate': 0.005
```

---

## 技术栈 💻

- Python 3.x
- NumPy - 数值计算
- Pandas - 数据处理

---

**课程项目**: COMP5434  
**完成时间**: 2025-11-06
