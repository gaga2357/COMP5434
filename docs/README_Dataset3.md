# Dataset3 解决方案使用说明

## 文件说明

- `dataset3_solution.py`: 主要解决方案(神经网络实现)
- `dataset3_logistic.py`: 替代方案(逻辑回归实现)

## 环境要求

```bash
pip install numpy pandas
```

**注意**: 本解决方案完全不使用sklearn,所有算法均从零实现。

## 数据文件准备

请确保以下文件在同一目录:
- `train.csv`: 训练数据
- `test.csv`: 测试数据

数据格式要求:
- 训练集: 包含特征列和标签列
- 测试集: 包含特征列和ID列

## 使用方法

### 方案1: 神经网络(推荐)

```bash
python dataset3_solution.py
```

**超参数调整**:
在代码中修改以下参数:
```python
HIDDEN_LAYERS = [128, 64, 32]  # 隐藏层结构
LEARNING_RATE = 0.01           # 学习率
EPOCHS = 200                   # 训练轮数
BATCH_SIZE = 64                # 批次大小
```

### 方案2: 逻辑回归

```bash
python dataset3_logistic.py
```

**超参数调整**:
```python
LEARNING_RATE = 0.1
EPOCHS = 1000
BATCH_SIZE = 128
```

## 输出结果

运行完成后会生成:
- `submission.csv`: 可提交至Kaggle的预测结果

格式:
```
id,label
0,1
1,0
2,2
...
```

## 算法说明

### 神经网络 (dataset3_solution.py)
- **架构**: 多层感知机(MLP)
- **激活函数**: ReLU(隐藏层) + Softmax(输出层)
- **损失函数**: 交叉熵损失
- **优化器**: Mini-batch梯度下降
- **初始化**: He初始化

### 逻辑回归 (dataset3_logistic.py)
- **模型**: Softmax回归(多分类逻辑回归)
- **损失函数**: 交叉熵损失
- **优化器**: 批量梯度下降
- **正则化**: L2正则化(可选)

## 调优建议

1. **学习率**:
   - 过大: 损失不收敛或震荡
   - 过小: 收敛太慢
   - 建议范围: 0.001 - 0.1

2. **网络结构**:
   - 简单问题: [64, 32]
   - 中等复杂度: [128, 64, 32]
   - 复杂问题: [256, 128, 64]

3. **训练轮数**:
   - 观察验证集准确率
   - 出现过拟合时减少轮数

4. **批次大小**:
   - 小批次(32-64): 更新频繁,可能更快收敛
   - 大批次(128-256): 更稳定但可能需要更多轮数

## 常见问题

**Q: 如何处理数据列名不匹配?**
A: 代码会自动检测ID列和标签列,支持常见命名如'id', 'ID', 'label', 'target'等。

**Q: 训练时间过长怎么办?**
A: 减少EPOCHS或使用逻辑回归方案。

**Q: 准确率不理想怎么办?**
A: 
1. 增加网络层数或神经元数量
2. 调整学习率
3. 增加训练轮数
4. 检查数据预处理是否正确

**Q: 出现nan或inf?**
A: 学习率可能过大,尝试减小学习率。

## 代码特点

- ✅ 完全不依赖sklearn
- ✅ 使用numpy实现所有算法
- ✅ 完整的注释和文档
- ✅ 支持验证集评估
- ✅ 自动数据预处理
- ✅ 可配置的超参数
